<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Intest at the Command Line</title>
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">
		<link href="../inweb.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body>
		<nav role="navigation">
		<h1><a href="../index.html">
<img src="../docs-src/Figures/Intest.png" height=72">
</a></h1>
<ul><li><a href="index.html"><span class="selectedlink">intest</span></a></li>
</ul><h2>Foundation Module</h2><ul>
<li><a href="../../../inweb/docs/foundation-module/index.html">foundation</a></li>
</ul><h2>Repository</h2><ul>
<li><a href="https://github.com/ganelson/intest"><img src="../github.png" height=18> github</a></li>
</ul><h2>Related Projects</h2><ul>
<li><a href="../../../inweb/docs/index.html">inweb</a></li>
<li><a href="../../../inform/docs/index.html">inform</a></li>

</ul>
		</nav>
		<main role="main">
		
<!--Weave of 'Intest at the Command Line' generated by 7-->
<ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">intest</a></li><li><a href="index.html#M">Manual</a></li><li><b>Intest at the Command Line</b></li></ul><p class="purpose">Intest is controlled with a flexible range of command-line instructions.</p>

<ul class="toc"><li><a href="#SP1">&#167;1. Specifying what to test</a></li><li><a href="#SP3">&#167;3. History and substitution</a></li><li><a href="#SP4">&#167;4. Command line arguments</a></li><li><a href="#SP5">&#167;5. The options</a></li><li><a href="#SP6">&#167;6. Using</a></li><li><a href="#SP7">&#167;7. Doing</a></li><li><a href="#SP9">&#167;9. Output redirection</a></li><li><a href="#SP10">&#167;10. Reporting on test outcomes in the Inform app</a></li><li><a href="#SP11">&#167;11. Skein file testing</a></li></ul><hr class="tocbar">

<p class="inwebparagraph"><a id="SP1"></a><b>&#167;1. Specifying what to test. </b>Intest tests just one project at a time, and the first thing to do is
specify which. The general form is:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> PROJECT COMMAND</span>
</pre>

<p class="inwebparagraph">or, in case the <code class="display"><span class="extract">PROJECT</span></code> directory happens to begin with a hyphen and could
be confused with the name of a command-line switch,
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="identifier"> -from</span><span class="plain"> PROJECT COMMAND</span>
</pre>

<p class="inwebparagraph"><code class="display"><span class="extract">PROJECT</span></code> is optional if the <code class="display"><span class="extract">COMMAND</span></code> is simply <code class="display"><span class="extract">-help</span></code> or <code class="display"><span class="extract">-version</span></code>,
when of course no actual testing will happen.
</p>

<p class="inwebparagraph">The rest of this section is entirely about how to write a <code class="display"><span class="extract">COMMAND</span></code>.
</p>

<p class="inwebparagraph"><a id="SP2"></a><b>&#167;2.  </b>Intest expects that <code class="display"><span class="extract">PROJECT</span></code> will be a directory, and that it will further
contain a subdirectory called <code class="display"><span class="extract">Tests</span></code>. But that is really the only assumption
it makes: there is no requirement for the project to be a web in the sense of
Inweb, or to be one of the Inform tools.
</p>

<p class="inwebparagraph"><a id="SP3"></a><b>&#167;3. History and substitution. </b>For each different project <code class="display"><span class="extract">PROJECT</span></code>, Intest maintains a history of recent
commands in a file stored at:
</p>

<pre class="display">
        <span class="plain">PROJECT/Tests/intest-history.txt</span>
</pre>

<p class="inwebparagraph">If Intest can't find this file, it silently continues; it will rewrite, or
create, this file when it exits, unless the <code class="display"><span class="extract">-no-history</span></code> setting is used.
(When Intest is being used less interactively &mdash; for example, inside the
Inform user interface app &mdash; this setting avoids clutter.)
</p>

<p class="inwebparagraph">The first thing Intest does with a <code class="display"><span class="extract">COMMAND</span></code> is to make substitutions.
A <code class="display"><span class="extract">COMMAND</span></code> consisting of just "?" lists the project's current history, like so:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7 ?</span>
        <span class="plain">?1. cases</span>
        <span class="plain">?2. Abolition</span>
        <span class="plain">?3. Beatles Sackcloth Gelato</span>
        <span class="plain">?4. problems</span>
        <span class="plain">1 = PM_ActivityOf; 2 = PM_AdjectiveIsValue</span>
</pre>

<p class="inwebparagraph">(If there's no recorded history, output is empty.) What this means is that
there have been four previous commands, called <code class="display"><span class="extract">?1</span></code> to <code class="display"><span class="extract">?4</span></code>. There are also
two test cases recently found to be troublesome, called <code class="display"><span class="extract">1</span></code> and <code class="display"><span class="extract">2</span></code>. History
is maintained for the previous 20 commands.
</p>

<p class="inwebparagraph">Intest uses both of these notations to save typing. The command <code class="display"><span class="extract">?3</span></code>, for
example, abbreviates <code class="display"><span class="extract">Beatles Sackcloth Gelato</span></code>. Thus:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7 ?3</span>
        <span class="plain">Repeating: ?3. Beatles Sackcloth Gelato</span>
        <span class="plain">...</span>
</pre>

<p class="inwebparagraph">is equivalent to typing:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7 Beatles Sackcloth Gelato</span>
</pre>

<p class="inwebparagraph">except that it doesn't add a new line to the history file, since this is a repeat of an old command, not a new one.
</p>

<p class="inwebparagraph">Calling intest with an empty command repeats its most recent new command:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7</span>
        <span class="plain">Repeating: ?4. problems</span>
        <span class="plain">...</span>
</pre>

<p class="inwebparagraph">Finally, intest automatically expands any command line arguments consisting
only of positive decimal numbers into the names recorded in the history. Thus
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7 1 2</span>
        <span class="plain">Expanded to: ?5. PM_ActivityOf PM_AdjectiveIsValue</span>
        <span class="plain">...</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP4"></a><b>&#167;4. Command line arguments. </b>At this point, then, the command no longer has any <code class="display"><span class="extract">?</span></code>, <code class="display"><span class="extract">?n</span></code> or <code class="display"><span class="extract">n</span></code> tokens
in it, because those have all been taken care of. What remains is a "raw
command". This takes the form:
</p>

<pre class="display">
        <span class="plain">OPTIONS -using USING -do DO</span>
</pre>

<p class="inwebparagraph"><code class="display"><span class="extract">OPTIONS</span></code>, which can be nothing at all, sets overall switches such as
<code class="display"><span class="extract">-no-history</span></code>. See below. <code class="display"><span class="extract">-using</span></code> tells Intest where to find test cases;
that too is optional. <code class="display"><span class="extract">-do</span></code> tells Intest which test cases to run. If there
isn't a <code class="display"><span class="extract">-using</span></code> block, there's no need to say <code class="display"><span class="extract">-do</span></code>, so simply
</p>

<pre class="display">
        <span class="plain">OPTIONS DO</span>
</pre>

<p class="inwebparagraph">will work. For example,
</p>

<pre class="display">
        <span class="plain">-no-history bigarrays badvariables</span>
</pre>

<p class="inwebparagraph">would set the option <code class="display"><span class="extract">-no-history</span></code> and then perform a "do" on the two test
cases named.
</p>

<p class="inwebparagraph"><a id="SP5"></a><b>&#167;5. The options. </b>Are as follows:
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-history</span></code> and <code class="display"><span class="extract">-no-history</span></code> turn the writing of command history on or off.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-colours</span></code> and <code class="display"><span class="extract">-no-colours</span></code> turn on or off the use of red and green terminal
text to show deletions and insertions when displaying differences.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-verbose</span></code> and <code class="display"><span class="extract">-no-verbose</span></code> turn on or off the echoing of shell commands to
the standard output. (Unlike make, Intest is by default silent.)
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-threads=N</span></code> tells Intest to use up to <code class="display"><span class="extract">N</span></code> independent threads, with one test
at a time running on each thread. Experience shows that setting <code class="display"><span class="extract">N</span></code> to be
the number of processor cores you have, doubling if you have hyperthreading,
gives the fastest performance. <code class="display"><span class="extract">-threads=1</span></code> makes Intest run in a single
thread, which may be necessary on some platforms.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-purge</span></code> is an option used only when testing Inform 7; it's a convenience for
removing the many temporary files created in the course of testing.
</p>

<p class="inwebparagraph"><a id="SP6"></a><b>&#167;6. Using. </b>Before it can do any testing, Intest has to discover the universe of possible
named test cases available, and work out which recipe to use with each.
</p>

<p class="inwebparagraph">It normally does that by reading a recipe file stored at:
</p>

<pre class="display">
        <span class="plain">PROJECT/Tests/PROJECT.intest</span>
</pre>

<p class="inwebparagraph">This is because the default <code class="display"><span class="extract">-using</span></code> setting is
</p>

<pre class="display">
        <span class="plain">-using PROJECT/Tests/PROJECT.intest</span>
</pre>

<p class="inwebparagraph">You can alternatively say <code class="display"><span class="extract">-using R</span></code> for any recipe file <code class="display"><span class="extract">R</span></code>, which need not
be in the project folder.
</p>

<p class="inwebparagraph">It is also possible, though seldom useful, to give your recipe instructions
at the command line and not in a recipe file at all. Newcomers to Intest
should simply skip the following discussion, but:
</p>

<pre class="display">
        <span class="plain">-using USE1 USE2 ... USEn</span>
</pre>

<p class="inwebparagraph">can instead be a list of use commands, some of a single token, some of
two or more. These can be:
</p>

<p class="inwebparagraph"></p>

<ul class="items"><li>(a) <code class="display"><span class="extract">-if P</span></code>, where <code class="display"><span class="extract">P</span></code> is a platform name, such as "windows". Act on the
succeeding use commands only if the platform is <code class="display"><span class="extract">P</span></code>.
</li></ul>
<ul class="items"><li>(b) <code class="display"><span class="extract">-endif</span></code>. Go back to always acting on use commands.
</li></ul>
<ul class="items"><li>(c) <code class="display"><span class="extract">-set VAR VALUE</span></code>. Set the given variable to the given value.
</li></ul>
<ul class="items"><li>(d) <code class="display"><span class="extract">-groups PATH</span></code>. Sets the groups directory to the given pathname;
failing which, any <code class="display"><span class="extract">.testgrpup</span></code> files (see below) are looked for in the
currently seleced directory.
</li></ul>
<ul class="items"><li>(e) <code class="display"><span class="extract">[NAME]</span></code>. Sets the test recipe to be used for the cases about to be
discovered. All recipe names are in square brackets; the default is just
<code class="display"><span class="extract">[Recipe]</span></code>.
</li></ul>
<ul class="items"><li>(f) A choice of test case type: <code class="display"><span class="extract">-extension</span></code>, <code class="display"><span class="extract">-case</span></code>, <code class="display"><span class="extract">-problem</span></code>, <code class="display"><span class="extract">-map</span></code>
or <code class="display"><span class="extract">-example</span></code>. This indicates that the next run of tokens will be
filenames of individual test cases of that type.
</li></ul>
<ul class="items"><li>(g) A pluralised choice of these: <code class="display"><span class="extract">-extensions</span></code>, <code class="display"><span class="extract">-cases</span></code>, <code class="display"><span class="extract">-problems</span></code>,
<code class="display"><span class="extract">-maps</span></code> or <code class="display"><span class="extract">-examples</span></code>. This indicates that the next run of tokens will be
pathnames of directories holding multiple test cases of that type.
</li></ul>
<ul class="items"><li>(h) A filename or directory name. Look here for test cases of the current
type, and assign them the current recipe.
</li></ul>
<p class="inwebparagraph">(Test types, and what it means to scan a directory for test cases, will be
gone into in the next section.)
</p>

<p class="inwebparagraph"><a id="SP7"></a><b>&#167;7. Doing. </b>The "doing" part of an Intest command is usually a list of test cases to
be tried. For example,
</p>

<pre class="display">
        <span class="plain">alpha beta gamma</span>
</pre>

<p class="inwebparagraph">is implicitly read as
</p>

<pre class="display">
        <span class="plain">-test alpha beta gamma</span>
</pre>

<p class="inwebparagraph">since <code class="display"><span class="extract">-test</span></code> is understood if no other do command is given.
</p>

<p class="inwebparagraph">Any number of names can be supplied, each of which must be one of the
following:
</p>

<p class="inwebparagraph"></p>

<ul class="items"><li>(i) <code class="display"><span class="extract">all</span></code> means all known tests;
</li><li>(ii) <code class="display"><span class="extract">examples</span></code>, <code class="display"><span class="extract">extensions</span></code>, <code class="display"><span class="extract">problems</span></code>, <code class="display"><span class="extract">cases</span></code>, <code class="display"><span class="extract">maps</span></code> each mean all
known tests of the given type of origin;
</li><li>(iii) <code class="display"><span class="extract">A</span></code>, <code class="display"><span class="extract">B</span></code>, <code class="display"><span class="extract">C</span></code>, ..., mean "the example with this letter in the (first)
extension case";
</li><li>(iv) <code class="display"><span class="extract">^1</span></code>, <code class="display"><span class="extract">^2</span></code>, <code class="display"><span class="extract">^3</span></code>, ..., mean "the 1st (2nd, 3rd, ...) test case known",
&mdash; this is not to be confused with the <code class="display"><span class="extract">1</span></code>, <code class="display"><span class="extract">2</span></code>, <code class="display"><span class="extract">3</span></code>, ... notation used
to call back previously failed cases: typically <code class="display"><span class="extract">^1</span></code> will be the first
test case alphabetically;
</li><li>(v) a name containing a <code class="display"><span class="extract">%</span></code> character will be treated as a regular expression,
in the same notation as for <code class="display"><span class="extract">-find</span></code> (see below) - for example, <code class="display"><span class="extract">BIP-%c+</span></code>
will mean "any test case whose name or title begins with <code class="display"><span class="extract">BIP-</span></code>";
</li><li>(vi) a name beginning with a <code class="display"><span class="extract">:</span></code> will be treated as a "group", and will
run all tests in that group &mdash; which is to say, the ones listed in the
group's file: <code class="display"><span class="extract">:wrangly</span></code> will run all tests listed in <code class="display"><span class="extract">wrangly.testgroup</span></code>,
multithreaded, whereas a double colon <code class="display"><span class="extract">::wrangly</span></code> runs them one at a time;
</li><li>(vii) and finally, of course, an explicit test case name refers to that test case.
</li></ul>
<p class="inwebparagraph">(Test types will be gone into in the next section.)
</p>

<p class="inwebparagraph"><a id="SP8"></a><b>&#167;8.  </b>But other do commands are also available:
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-catalogue</span></code>: List all the known test cases. For large projects this might
produce an enormous list, but <code class="display"><span class="extract">-using</span></code> can cut that down. To give an example
from Inform,
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7</span><span class="identifier"> -using -extension</span><span class="plain"> 'inform7/Internal/Extensions/Emily Short/Locksmith.i7x'</span><span class="identifier"> -do -catalogue</span>
        <span class="plain">Locksmith Example A = John Malkovich's Toilet</span>
        <span class="plain">Locksmith Example B = Tobacco</span>
        <span class="plain">Locksmith Example C = Rekeying</span>
        <span class="plain">Locksmith Example D = Watchtower</span>
</pre>

<p class="inwebparagraph">Here the universe of possible tests is reduced to just those which are given
in the documentation for this specific Inform extension. The <code class="display"><span class="extract">-catalogue</span></code>
then gives a full list of those four.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-find &lt;text&gt;</span></code>: List all the known test cases whose case names or story
titles match <code class="display"><span class="extract">&lt;text&gt;</span></code>. This can in fact be a regular expression, using
<code class="display"><span class="extract">[...]</span></code>, <code class="display"><span class="extract">%c</span></code> for any character (not <code class="display"><span class="extract">.</span></code>), <code class="display"><span class="extract">%C</span></code> for any non-white-space, <code class="display"><span class="extract">%d</span></code>
for a digit, and so on. For example:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7</span><span class="identifier"> -find</span><span class="plain"> %d%d%d%d</span>
        <span class="plain">Test cases matching '%d%d%d%d':</span>
        <span class="plain">Jamaica1688 = Jamaica 1688</span>
        <span class="plain">Mapped = 1691</span>
        <span class="plain">Royal = 1691</span>
        <span class="plain">Royal2 = 1691</span>
        <span class="plain">Royal3 = 1691</span>
        <span class="plain">SP = Space Patrol #57 - 1953-10-31 - Stranded on Jupiter!</span>
        <span class="plain">Stoppers = Trachypachidae Maturin 1803</span>
</pre>

<p class="inwebparagraph">(The reason for the equals signs here, and in the above example too, is that
an individual test case can have both a "name" &mdash; such as <code class="display"><span class="extract">Stoppers</span></code> &mdash; and also
a "title" &mdash; such as "Trachypachidae Maturin 1803". The name is derived from
its filename. The title will only exist for cases extracted from Inform
example or extension files, and then it's the title of the story making up
the test case.)
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-source &lt;cases&gt;</span></code>: Output the contents of the test cases. This sounds
as if it does no more than printing out their source files, but it's a
non-trivial operation for some Inform test cases (those occurring as examples
or in extensions).
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-script &lt;cases&gt;</span></code>: This is relevant only for testing Inform. Output the
script of player inputs to be used when running the story file produced
by compiling this test case; the script being drawn from the
</p>

<blockquote>
    <p>Test me with "...".</p>

</blockquote>

<p class="inwebparagraph">line inside the source, if one is present. If no script is there, this
produces empty output, but does not throw an error. For example:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest</span><span class="identifier"> -using -extension</span><span class="plain"> 'inform7/Internal/Extensions/Emily Short/Locksmith.i7x'</span><span class="identifier"> -do -script</span><span class="plain"> C</span>
        <span class="plain">i</span>
        <span class="plain">x key</span>
        <span class="plain">unlock box</span>
        <span class="plain">i</span>
        <span class="plain">x key</span>
</pre>

<p class="inwebparagraph">which is the command script for Example C of Locksmith:
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-concordance &lt;cases&gt;</span></code>: Output a concordance table for comparing line numbers
between the source text extracted by Intest vs. the original file they came
from. This is a sequence of lines of the form:
</p>

<pre class="display">
        <span class="plain">1 +404</span>
</pre>

<p class="inwebparagraph">which means "from line 1 of the extracted output onwards, you have to add
404 to get the corresponding line of the original from which it came". There can
be any number of such lines, including none at all (which means: the line
numbers match); e.g.
</p>

<pre class="display">
        <span class="plain">1 +404</span>
        <span class="plain">21 +409</span>
</pre>

<p class="inwebparagraph">means add 404 to lines 1 to 20, then add 409 from then on, presumably because
5 lines have been skipped. The list is always of minimal length and any offsets
quoted are always positive, so <code class="display"><span class="extract">+0</span></code> or <code class="display"><span class="extract">+-7</span></code> can't occur.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-bless &lt;cases&gt;</span></code>: Test and then, if the case is cursed, bless the transcript
as correct. (If the case is already blessed, nothing changes.)
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-rebless &lt;cases&gt;</span></code>: Test and then bless the transcript as correct, replacing
any existing blessed transcript: equivalent to <code class="display"><span class="extract">-curse</span></code> followed by <code class="display"><span class="extract">-bless</span></code>.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-curse &lt;cases&gt;</span></code>: Delete the blessed transcript for these cases. (Alas,
there's no such thing as <code class="display"><span class="extract">-recurse</span></code>.)
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-show &lt;cases&gt;</span></code>: Run a test just as far as the first <code class="display"><span class="extract">show</span></code> step in its recipe,
and then print out the file specified. For most recipes, this prints out, say,
the console output generated by the program being tested.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-show-i6 &lt;cases&gt;</span></code>: Run a test just as far as taking it through the I6 compiler stage, and show the console output from I6. (This is for Inform only.)
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-show-t &lt;cases&gt;</span></code>: Run a test, and show the transcript of play from the
resulting story file. (This is for Inform only.)
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-debug &lt;cases&gt;</span></code>: Run a test, but when you get to the Inform 7 compiler stage, run it in the <code class="display"><span class="extract">lldb</span></code> debugger and do not redirect <code class="display"><span class="extract">stdout</span></code> or <code class="display"><span class="extract">stderr</span></code>. (This is for Inform only.)
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-open &lt;cases&gt;</span></code>: Call the shell command <code class="display"><span class="extract">open</span></code> on the file(s) from which the source text of these case(s) are drawn. On MacOS, for example, this is equivalent to double-clicking them in the Finder, and likely means they will open in the default text editor.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-diff &lt;cases&gt;</span></code>: Test and then, if a <code class="display"><span class="extract">match</span></code> step fails in its recipe, run
the shell command <code class="display"><span class="extract">diff</span></code> on the actual versus ideal versions of the output
being matched.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">-bbdiff &lt;cases&gt;</span></code>: Like <code class="display"><span class="extract">-diff</span></code>, but using the <code class="display"><span class="extract">bbdiff</span></code> tool instead. You will only have this if you're running the BBEdit text editor on MacOS.
</p>

<p class="inwebparagraph"><a id="SP9"></a><b>&#167;9. Output redirection. </b>Do commands producing textual output, such as <code class="display"><span class="extract">-source</span></code>, normally send that to
the standard output stdout. (If you're using Intest in a <code class="display"><span class="extract">bash</span></code> or similar
shell on a Unix-based operating system, this means it can be piped to an
application or redirected to a file.) But you can also ask Intest itself to
redirect the output, since any action can optionally be followed by
<code class="display"><span class="extract">-to &lt;filename&gt;</span></code>.
</p>

<p class="inwebparagraph">This redirects output to the given file, which is created (and overwrites any
file already existing with that name). In a <code class="display"><span class="extract">-to</span></code> destination, any usage in
the filename of the text <code class="display"><span class="extract">[NAME]</span></code> expands to the name of the test case; any
usage of <code class="display"><span class="extract">[NUMBER]</span></code> expands to a unique integer, counting upwards from 1, for
each test case being applied to by this action. Thus, for example:
</p>

<pre class="display">
        <span class="plain">-source A B C D -to source_[NAME].txt</span>
</pre>

<p class="inwebparagraph">might write four files, called, say,
</p>

<pre class="display">
        <span class="plain">source_Locksmith Example A.txt</span>
        <span class="plain">source_Locksmith Example B.txt</span>
        <span class="plain">source_Locksmith Example C.txt</span>
        <span class="plain">source_Locksmith Example D.txt</span>
</pre>

<p class="inwebparagraph">Note that if you write multiple do commands, they can each have independent
<code class="display"><span class="extract">-to</span></code> destinations.
</p>

<p class="inwebparagraph"><a id="SP10"></a><b>&#167;10. Reporting on test outcomes in the Inform app. </b>Two special do commands are provided for use of the Inform app only (well,
it's hard to think of anyone else who would need them). The idea here is that
after the Inform app has conducted a test, it asks intest to produce an HTML
page to describe the results of the test, passing over the information needed
to do this:
</p>

<pre class="display">
        <span class="plain">-report &lt;case&gt; &lt;code&gt; &lt;problems-file&gt; &lt;skein-file&gt;</span>
</pre>

<p class="inwebparagraph">Here <code class="display"><span class="extract">&lt;case&gt;</span></code> is a single case, not a list, and <code class="display"><span class="extract">&lt;code&gt;</span></code> is one of:
</p>

<p class="inwebparagraph"></p>

<ul class="items"><li>(a) <code class="display"><span class="extract">i7</span></code>: meaning, failed i7, i.e., <code class="display"><span class="extract">inform7</span></code> produced problem messages
</li><li>(b) <code class="display"><span class="extract">i6</span></code>: meaning, failed to compile in i6
</li><li>(c) <code class="display"><span class="extract">wrong</span></code>: meaning, the story file compiled and started, but the transcript didn't match its blessed version
</li><li>(d) <code class="display"><span class="extract">right</span></code>: meaning, a success: story file compiled and started, and matched transcript
</li></ul>
<p class="inwebparagraph"><code class="display"><span class="extract">&lt;problems-file&gt;</span></code> is the file generated by <code class="display"><span class="extract">inform7</span></code>, in the event of either success or failure, which is usually stored in the project's <code class="display"><span class="extract">Build/Problems.html</span></code>.
</p>

<p class="inwebparagraph"><code class="display"><span class="extract">&lt;skein-file&gt;</span></code> is only looked at (potentially) in case (c), and is the skein file for the example in question; at present it's ignored.
</p>

<p class="inwebparagraph">For example:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest/Tangled/intest</span><span class="plain"> inform7</span>
            <span class="plain">-using -extension Locksmith.i7xp/Source/extension.i7x</span>
            <span class="plain">-do -report C i7 Locksmith.i7xp/Build/Problems.html Locksmith.i7xp/Skein.skein</span>
</pre>

<p class="inwebparagraph">reports on the failure of example C from the <code class="display"><span class="extract">Locksmith.i7xp</span></code> project. The
output is HTML, but sent to stdout by default; use something like
</p>

<pre class="display">
        <span class="plain">-to Locksmith.i7xp/Build/Problems-3.html</span>
</pre>

<p class="inwebparagraph">to redirect this to a particular file.
</p>

<p class="inwebparagraph">The second special action is <code class="display"><span class="extract">-combine</span></code>. This assumes that the Inform app has
already performed <code class="display"><span class="extract">N</span></code> such tests, where <code class="display"><span class="extract">N &gt;= 1</span></code>, and has called Intest with
the <code class="display"><span class="extract">-report</span></code> action on each in turn, redirecting the output to a series of
files. What <code class="display"><span class="extract">-combine</span></code> does is to read all of those files in and merge them
into a consolidated report, which, once again, it writes as HTML. The format
here is:
</p>

<pre class="display">
        <span class="plain">-combine &lt;base-filename&gt; -&lt;N&gt;</span>
</pre>

<p class="inwebparagraph">The filenames of the individual reports are assumed to be <code class="display"><span class="extract">&lt;base-filename&gt;</span></code>
but with "-1", "-2", ..., tacked on before the file extension. Thus:
</p>

<pre class="display">
        <span class="element">$</span><span class="plain"> </span><span class="functiontext">intest</span><span class="identifier"> -using -extension</span><span class="plain"> Locksmith.i7xp/Source/extension.i7x</span>
            <span class="plain">-do -combine Locksmith.i7xp/Build/Problems.html -4</span>
            <span class="plain">-to Locksmith.i7xp/Build/Consolidated.html</span>
</pre>

<p class="inwebparagraph">reads in
</p>

<pre class="display">
        <span class="plain">Locksmith.i7xp/Build/Problems-1.html</span>
        <span class="plain">Locksmith.i7xp/Build/Problems-2.html</span>
        <span class="plain">Locksmith.i7xp/Build/Problems-3.html</span>
        <span class="plain">Locksmith.i7xp/Build/Problems-4.html</span>
</pre>

<p class="inwebparagraph">and writes out a consolidated report into
</p>

<pre class="display">
        <span class="plain">Locksmith.i7xp/Build/Consolidated.html</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP11"></a><b>&#167;11. Skein file testing. </b>In order to be used by the Testing panel in the Inform app, intest also supports the following:
</p>

<pre class="display">
        <span class="plain">-test-skein &lt;file&gt; &lt;node-id&gt;</span>
</pre>

<p class="inwebparagraph">This reads the specified <code class="display"><span class="extract">.skein</span></code> file, looks for the node in it with the given ID, and runs intest's diff algorithm on the actual versus blessed transcript at that node. The output is in simple HTML format.
</p>

<hr class="tocbar">
<ul class="toc"><li><a href="M-iti.html">Back to 'Introduction to Intest'</a></li><li><a href="M-wir.html">Continue with 'Writing Intest Recipes'</a></li></ul><hr class="tocbar">
<!--End of weave-->
		</main>
	</body>
</html>


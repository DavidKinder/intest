<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>The Universe of Cases</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/ConsoleText-Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<h1><a href="../index.html">
<img src="../docs-assets/Intest.png" height=72">
</a></h1>
<ul><li><a href="index.html"><span class="selectedlink">intest</span></a></li>
</ul><h2>Repository</h2><ul>
<li><a href="https://github.com/ganelson/intest"><img src="../docs-assets/github.png" height=18> github</a></li>
</ul><h2>Related Projects</h2><ul>
<li><a href="../../../inweb/docs/index.html">inweb</a></li>
<li><a href="../../../inform/docs/index.html">inform</a></li>

</ul>
		</nav>
		<main role="main">
		<!--Weave of 'The Universe of Cases' generated by Inweb-->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">intest</a></li><li><a href="index.html#M">Manual</a></li><li><b>The Universe of Cases</b></li></ul></div>
<p class="purpose">How to specify what test cases exist for a project.</p>

<ul class="toc"><li><a href="M-tuoc.html#SP1">&#167;1. The intest file</a></li><li><a href="M-tuoc.html#SP3">&#167;3. Names of test cases</a></li><li><a href="M-tuoc.html#SP5">&#167;5. Types of test case</a></li><li><a href="M-tuoc.html#SP8">&#167;8. Declaring the test cases</a></li><li><a href="M-tuoc.html#SP14">&#167;14. Test groups</a></li><li><a href="M-tuoc.html#SP15">&#167;15. Specifying the recipes</a></li><li><a href="M-tuoc.html#SP16">&#167;16. The annotations in a test case</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. The intest file. </b>Each project tested by Intest needs to provide a file which says what
test cases exist and how to test them. This range of test cases is called
the "universe", and may contain thousands of possible tests, though Intest
is likely to act on only a few in any given run.
</p>

<p class="commentary">As previously noted, Intest needs a recipe file in order to run in any
useful fashion; by default, Intest expects to find this file at
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    PROJECT/Tests/PROJECT.intest</span>
</pre>
<p class="commentary">where <span class="extract"><span class="extract-syntax">PROJECT</span></span> is the name of the tested project's home directory. But
with the <span class="extract"><span class="extract-syntax">-using</span></span> switch at the command line, an alternative file can be
used somewhere else.
</p>

<p class="commentary">(Note that if Intest is being used in its simplified mode for testing Inform
extensions or kits, then there is no need to write an intest file or to
write recipes, so that this section can be ignored. But if you're curious,
it does this by running the generic file <span class="extract"><span class="extract-syntax">inform7/Internal/Delia/extension.intest</span></span>,
a generic intest file which can be used with any directory extension or kit.)
</p>

<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2.  </b>The intest file is a UTF-8 encoded text file. It is a list of commands
which, for the most part, tell Intest where to find test cases, and then
definitions of recipes, which Intest can then use to test them.
</p>

<p class="commentary">Here is a typical simple recipe file. It begins with a command, telling Intest
the location of a directory of test cases which will have type <span class="extract"><span class="extract-syntax">case</span></span>, and
then gives a single recipe, which Intest will use on whatever cases it
discovered in that directory.
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">! This is my first try at testing the launcher program</span>

<span class="identifier-syntax">-cases</span><span class="plain-syntax"> 'inform7/kinds-test/Tests/Test Cases'</span>

<span class="identifier-syntax">-recipe</span>
<span class="reserved-syntax">    set</span><span class="plain-syntax">: </span><span class="function-syntax">$SOURCE</span><span class="plain-syntax"> = </span><span class="function-syntax">$PATH</span><span class="plain-syntax">/</span><span class="function-syntax">$CASE</span><span class="plain-syntax">.txt</span>
<span class="reserved-syntax">    set</span><span class="plain-syntax">: </span><span class="function-syntax">$A</span><span class="plain-syntax"> = </span><span class="function-syntax">$PATH</span><span class="plain-syntax">/</span><span class="function-syntax">$CASE</span><span class="plain-syntax">--A.txt</span>
<span class="reserved-syntax">    set</span><span class="plain-syntax">: </span><span class="function-syntax">$I</span><span class="plain-syntax"> = </span><span class="function-syntax">$PATH</span><span class="plain-syntax">/</span><span class="function-syntax">$CASE</span><span class="plain-syntax">--I.txt</span>

<span class="reserved-syntax">    step</span><span class="plain-syntax">: launcher </span><span class="function-syntax">$SOURCE</span><span class="plain-syntax"> &gt;</span><span class="function-syntax">$A</span><span class="plain-syntax"> 2&gt;&amp;1</span>
<span class="reserved-syntax">    or</span><span class="plain-syntax">: 'launcher produced error messages' </span><span class="function-syntax">$A</span>

<span class="reserved-syntax">    show</span><span class="plain-syntax">: </span><span class="function-syntax">$A</span>

<span class="reserved-syntax">    exists</span><span class="plain-syntax">: </span><span class="function-syntax">$I</span>
<span class="reserved-syntax">    or</span><span class="plain-syntax">: 'passed without errors but no blessed output existed'</span>

<span class="reserved-syntax">    match text</span><span class="plain-syntax">: </span><span class="function-syntax">$A</span><span class="plain-syntax"> </span><span class="function-syntax">$I</span>
<span class="reserved-syntax">    or</span><span class="plain-syntax">: 'produced incorrect output'</span>

<span class="identifier-syntax">-end</span>
</pre>
<p class="commentary">The details of a recipe (written between <span class="extract"><span class="extract-syntax">-recipe</span></span> and <span class="extract"><span class="extract-syntax">-end</span></span> above) are
in a special language called Delia, which is described in <a href="M-wir.html" class="internal">Writing Intest Recipes</a>.
Otherwise, each line in this file is a command, and each command begins
with a dash <span class="extract"><span class="extract-syntax">-</span></span>, except that blank lines are ignored. So are comment lines,
beginning with exclamation marks <span class="extract"><span class="extract-syntax">!</span></span>.
</p>

<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. Names of test cases. </b>Each test has a name, which has to be not too long and can contain only
certain characters (see below for details). A test may also have a title,
which can be different and longer. For example, a test might have the name
<span class="extract"><span class="extract-syntax">DanDaresSpaceship</span></span> but the title "Dan Dare's Spaceship". Titles are not
very important to Intest, but names are.
</p>

<p class="commentary">Names typically come from the filenames of the files in which tests are
written. In the above example:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="identifier-syntax">-cases</span><span class="plain-syntax"> 'inform7/kinds-test/Tests/Test Cases'</span>
</pre>
<p class="commentary">if the directory given contained three files, <span class="extract"><span class="extract-syntax">numerical.txt</span></span>, <span class="extract"><span class="extract-syntax">text.txt</span></span>
and <span class="extract"><span class="extract-syntax">lists.txt</span></span>, then the universe would consist of three tests with
the names <span class="extract"><span class="extract-syntax">numerical</span></span>, <span class="extract"><span class="extract-syntax">text</span></span> and <span class="extract"><span class="extract-syntax">lists</span></span>.
</p>

<p class="commentary">There are a number of restrictions on test names:
</p>

<ul class="items"><li>(a) They are case-sensitive, so "Frogs" is different from "frogs". This
is true even if your file system is case-insensitive, as it probably is.
Your computer may regard <span class="extract"><span class="extract-syntax">Frogs.txt</span></span> and <span class="extract"><span class="extract-syntax">frogs.txt</span></span> as the same file,
but to Intest those names would refer to different cases. It follows
that you can't practicably have two case names which are the same except
for casing.
</li><li>(b) The names <span class="extract"><span class="extract-syntax">all</span></span>, <span class="extract"><span class="extract-syntax">examples</span></span>, <span class="extract"><span class="extract-syntax">extensions</span></span>, <span class="extract"><span class="extract-syntax">problems</span></span> and <span class="extract"><span class="extract-syntax">cases</span></span>
are reserved for Intest wildcards, and can't be used.
</li><li>(c) A name cannot begin with a dash <span class="extract"><span class="extract-syntax">-</span></span>, a caret <span class="extract"><span class="extract-syntax">^</span></span>, a question mark <span class="extract"><span class="extract-syntax">?</span></span>,
an exclamation mark <span class="extract"><span class="extract-syntax">!</span></span>, an open bracket <span class="extract"><span class="extract-syntax">(</span></span>, a square bracket <span class="extract"><span class="extract-syntax">[</span></span>,
a full stop <span class="extract"><span class="extract-syntax">.</span></span>, an underscore <span class="extract"><span class="extract-syntax">_</span></span>, or a digit. It's probably best to
start with a letter.
</li><li>(d) A name cannot consist only of digits and cannot be just a single letter.
</li><li>(e) A name cannot contain a colon or a slash, forwards or backwards, and
must contain only filename-safe characters. It can contain white space, but
your life will be easier if it doesn't. Similarly, best to avoid accented
letters or emoji.
</li><li>(f) A name cannot contain a double dash <span class="extract"><span class="extract-syntax">--</span></span>.
</li></ul>
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4.  </b>The reason that names cannot contain double dashes is that many tests need
associated files in order to work. A typical arrangement is that the test
<span class="extract"><span class="extract-syntax">DanDaresSpaceship</span></span> might produce the "actual" output <span class="extract"><span class="extract-syntax">DanDaresSpaceship--A.txt</span></span>,
which needs to be stored somewhere, and then this needs to be compared with
an "ideal" or "blessed" version, kept in <span class="extract"><span class="extract-syntax">DanDaresSpaceship--I.txt</span></span>.
</p>

<p class="commentary">Because these filenames have double dashes in them, Intest does not interpret
them as being tests in their own right: when scanning a directory for test
cases, it ignores them.
</p>

<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. Types of test case. </b>There are four of these, though two are used only for testing Inform 7,
and can be ignored by everybody else. The general ones are:
</p>

<ul class="items"><li>(a) "case" &mdash; where the expectation is that the program being tested will
accept this test case and not produce errors, and
</li><li>(b) "problem" &mdash; where the expectation is that the program will reject it
with error messages.
</li></ul>
<p class="commentary">The Inform-specific ones are:
</p>

<ul class="items"><li>(c) "example" &mdash; like a "case", but written into an Inform documentation file,
a format which takes a bit of decoding.
</li><li>(d) "extension" &mdash; like a "case", but one of the examples from an Inform extension
file, a format which takes even more decoding.
</li></ul>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6.  </b>In addition, some tests are "annotated", meaning that details about them
are given at the top of the file in question. For example, here is an
unannotated test case file:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    The internal text file of Tall Nettles is called "Nettles.txt".</span>

<span class="plain-syntax">    To begin:</span>
<span class="plain-syntax">        showme the file of Tall Nettles;</span>
<span class="plain-syntax">        let the line count be 1;</span>
<span class="plain-syntax">        repeat with T running through the file of Tall Nettles:</span>
<span class="plain-syntax">            say "[line count]  [T][line break]";</span>
<span class="plain-syntax">            increase the line count by 1.</span>
</pre>
<p class="commentary">And here is the same thing as an annotated file:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    Test: Nettles</span>
<span class="plain-syntax">    Language: Basic</span>
<span class="plain-syntax">    For: Glulx</span>
<span class="plain-syntax">    IntOptions: -u -q -dataresourcetext '3:$PATH/Nettles--X.txt'</span>

<span class="plain-syntax">    The internal text file of Tall Nettles is called "Nettles.txt".</span>

<span class="plain-syntax">    To begin:</span>
<span class="plain-syntax">        showme the file of Tall Nettles;</span>
<span class="plain-syntax">        let the line count be 1;</span>
<span class="plain-syntax">        repeat with T running through the file of Tall Nettles:</span>
<span class="plain-syntax">            say "[line count]  [T][line break]";</span>
<span class="plain-syntax">            increase the line count by 1.</span>
</pre>
<p class="commentary">The difference, of course, is that the file begins with a run of header
lines, each of which sets one detail. These take the form "Key: Value",
where Key must be a single word. In a test case file, the first line must
be "Test: TITLE", that is, the key must be "Test" and the value must be the
title of the test. In an annotated problem case file, the same, but the
key must be "Problem" rather than "Test".
</p>

<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7.  </b>All Inform example files are annotated. There, the opening line is a little
more elaborate:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    Example: ** Alpaca Farm 2</span>
</pre>
<p class="commentary">Here the opening line must have the key "Example" and the value is a row
of one to four asterisks, rating the example by difficulty, and then a title.
(This exactly follows the format used by the "indoc" tool for Inform:
examples come from Inform documentation.)
</p>

<p class="commentary">Similarly, all cases arising from extensions are "annotated".
</p>

<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. Declaring the test cases. </b>A recipe file normally begins by declaring where all the cases live:
</p>

<p class="commentary"><span class="extract"><span class="extract-syntax">-case F</span></span>, where <span class="extract"><span class="extract-syntax">F</span></span> is a filename. Make this a test case of type "case".
Similarly for <span class="extract"><span class="extract-syntax">-problem</span></span>, <span class="extract"><span class="extract-syntax">-example</span></span>, <span class="extract"><span class="extract-syntax">-extension</span></span>.
</p>

<p class="commentary"><span class="extract"><span class="extract-syntax">-cases D</span></span>, where <span class="extract"><span class="extract-syntax">D</span></span> is a directory name. Make every validly named text file
in this directory a test case of type "case". Similarly for <span class="extract"><span class="extract-syntax">-problems</span></span>,
<span class="extract"><span class="extract-syntax">-examples</span></span>, <span class="extract"><span class="extract-syntax">-extensions</span></span>.
</p>

<p class="commentary"><span class="extract"><span class="extract-syntax">-case</span></span> and <span class="extract"><span class="extract-syntax">-problem</span></span> create unannotated cases and problems: to make
annotated ones, use <span class="extract"><span class="extract-syntax">-annotated-case</span></span> and <span class="extract"><span class="extract-syntax">-annotated-problem</span></span>. Similarly
for their plurals. Intest also recognises <span class="extract"><span class="extract-syntax">-annotated-example</span></span> and <span class="extract"><span class="extract-syntax">-annotated-extension</span></span>,
but since tests from examples or extensions are always annotated anyway, this
doesn't change matters.
</p>

<p class="commentary">As a final variation, note that Intest will ordinarily throw an error if
it cannot find cases at the places named. If you don't want that, use the
prefix "-possible". For example, <span class="extract"><span class="extract-syntax">-possible-annotated-case</span></span>, <span class="extract"><span class="extract-syntax">-possible-problems</span></span>.
</p>

<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9.  </b>Each case has a "recipe" assigned to it, a method for performing the test.
Often the same recipe will be assigned to every case, but not all always.
</p>

<p class="commentary">Recipes are named, with names put in square brackets. The default one is
called just <span class="extract"><span class="extract-syntax">[Recipe]</span></span>, but any test case declaration can override that.
For example:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    -cases [KindRecipe] 'inform7/kinds-test/Tests/Test Cases'</span>
<span class="plain-syntax">    -possible-annotated-case [SpecialHack] 'inform7/kinds-test/Tests/debugging.txt'</span>
</pre>
<p class="commentary">Here any cases found in <span class="extract"><span class="extract-syntax">inform7/kinds-test/Tests/Test Cases</span></span> are given the
recipe <span class="extract"><span class="extract-syntax">[KindRecipe]</span></span>, and if the file <span class="extract"><span class="extract-syntax">inform7/kinds-test/Tests/debugging.txt</span></span>
is present, then it gets the recipe <span class="extract"><span class="extract-syntax">[SpecialHack]</span></span>.
</p>

<p class="commentary">Whatever happens, the recipe(s) you need will have to be written: see below
for how to do that.
</p>

<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10.  </b>If, for whatever reason, you would like a given test not to be included
in Intest's wildcard names such as <span class="extract"><span class="extract-syntax">all</span></span>, then you can write, say,
<span class="extract"><span class="extract-syntax">-singular NAME</span></span>, where <span class="extract"><span class="extract-syntax">NAME</span></span> is the test's name. For example, you might say:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    -possible-annotated-case [SpecialHack] 'inform7/kinds-test/Tests/debugging.txt'</span>
<span class="plain-syntax">    -singular debugging</span>
</pre>
<p class="commentary">to mark the test <span class="extract"><span class="extract-syntax">debugging</span></span>, which arises from the declaration, to be
excluded from <span class="extract"><span class="extract-syntax">all</span></span>.
</p>

<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11.  </b>With a large project to test, you will probably have a lot of tests which,
though similar to each other, involve subtle variations in how they should be
carried out. One answer to that would be to have numerous recipes which are
all variations on a theme:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    -cases [Reactor1] 'fusionreactor/Tests/HotCases'</span>
<span class="plain-syntax">    -cases [Reactor2] 'fusionreactor/Tests/ColdCases'</span>
<span class="plain-syntax">    -cases [Reactor3] 'fusionreactor/Tests/UnsafeCases'</span>
</pre>
<p class="commentary">But that is likely to result in having to write multiple, repetitive recipes.
A neater solution is to use "stipulations", like so:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="reserved-syntax">    -cases [Reactor</span><span class="plain-syntax">:TEMP=Hot:STATUS=Safe] 'fusionreactor/Tests/HotCases'</span>
<span class="reserved-syntax">    -cases [Reactor</span><span class="plain-syntax">:TEMP=Cold:STATUS=Safe] 'fusionreactor/Tests/ColdCases'</span>
<span class="reserved-syntax">    -cases [Reactor</span><span class="plain-syntax">:TEMP=Hot:STATUS=Unsafe] 'fusionreactor/Tests/UnsafeCases'</span>
</pre>
<p class="commentary">Here the recipe <span class="extract"><span class="extract-syntax">[Reactor]</span></span> will be used for all of these cases, but it will
start with the variables <span class="extract"><span class="extract-syntax">$TEMP</span></span> and <span class="extract"><span class="extract-syntax">$STATUS</span></span> set to values depending on
which bucket the tests came from. Note that those are local variables (i.e.,
different for each individual test), not global ones (the same for all).
</p>

<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12.  </b>It is also possible to set global variables which will apply to all recipes:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    -set MAXTEMPERATURE 4000</span>
</pre>
<p class="commentary">This would create the variable <span class="extract"><span class="extract-syntax">$$MAXTEMPERATURE</span></span>, which can be used by
every recipe. See below for more on Delia variables: the doubled dollar sign
means global, single means local.
</p>

<p class="commentary firstcommentary"><a id="SP13" class="paragraph-anchor"></a><b>&#167;13.  </b>Finally, test cases can be made available and globals can be set on a
platform-specific basis:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    -if Windows -set EXESUFFIX '.exe'</span>
<span class="reserved-syntax">    -if MacOS -annotated-cases [Main</span><span class="plain-syntax">:EXTERNAL=inform7/Tests] 'inform7/Tests/Test Releases'</span>
</pre>
<p class="commentary">A line beginning <span class="extract"><span class="extract-syntax">-if PLATFORM</span></span> will be obeyed only if <span class="extract"><span class="extract-syntax">$$platform</span></span> matches the
value <span class="extract"><span class="extract-syntax">PLATFORM</span></span>, case insensitively.
</p>

<p class="commentary firstcommentary"><a id="SP14" class="paragraph-anchor"></a><b>&#167;14. Test groups. </b><span class="extract"><span class="extract-syntax">-groups PATH</span></span> sets the groups directory to the given pathname. Any files
with the filename extension <span class="extract"><span class="extract-syntax">.testgroup</span></span> are then taken to be lists of useful
test cases for some particular aspect of testing.
</p>

<p class="commentary">A typical test group file is just a list of lines, each of which specifies
some tests drawn from the Universe. Most often these are literal test names:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    PM_RelationOtoVContradiction</span>
<span class="plain-syntax">    PM_BadRelationCondition</span>
<span class="plain-syntax">    Asym1to1</span>
<span class="plain-syntax">    ExoticCreation</span>
<span class="plain-syntax">    KOVEquivRelation</span>
<span class="plain-syntax">    OToORouteFinding</span>
</pre>
<p class="commentary">Blank lines are skipped, as are lines beginning with the comment character <span class="extract"><span class="extract-syntax">!</span></span>.
</p>

<p class="commentary">More ambitiously, lines can give regular expressions for tests to match. This
group consists of the test <span class="extract"><span class="extract-syntax">Soyuz</span></span> and anything whose name begins <span class="extract"><span class="extract-syntax">Ariane-</span></span>.
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    Soyuz</span>
<span class="plain-syntax">    Ariane-%C+</span>
</pre>
<p class="commentary">By default, these are matched against either the name or the title of a case:
a successful match against either gets the test included in the group. But
we can say exactly what we want to match against by writing the line
<span class="extract"><span class="extract-syntax">KEY includes PATTERN</span></span> or <span class="extract"><span class="extract-syntax">KEY is PATTERN</span></span>:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    Title includes %d%d</span>
<span class="plain-syntax">    Name is Pine2</span>
<span class="plain-syntax">    Language is Basic</span>
<span class="plain-syntax">    Description includes quick</span>
</pre>
<p class="commentary">This improbable group includes any test whose title has two consecutive digits
somewhere in it, or whose name is <span class="extract"><span class="extract-syntax">Pine2</span></span>, or which sets the key <span class="extract"><span class="extract-syntax">Language</span></span>
to the value <span class="extract"><span class="extract-syntax">Basic</span></span> in its annotations (see below), or which sets the
key <span class="extract"><span class="extract-syntax">Description</span></span> to something with the word "quick" in it.
</p>

<p class="commentary">It can sometimes be useful to see what tests this sort of thing actually implies:
</p>

<pre class="ConsoleText-displayed-code all-displayed-code code-font">
<span class="ConsoleText-plain-syntax">    </span><span class="ConsoleText-element-syntax">$</span><span class="ConsoleText-plain-syntax"> </span><span class="ConsoleText-function-syntax">intest/Tangled/intest</span><span class="ConsoleText-plain-syntax"> launcher</span><span class="ConsoleText-identifier-syntax"> -list</span><span class="ConsoleText-plain-syntax"> :rockets</span>
<span class="ConsoleText-plain-syntax">    Soyuz</span>
<span class="ConsoleText-plain-syntax">    Ariane-5</span>
<span class="ConsoleText-plain-syntax">    Ariane-6</span>
</pre>
<p class="commentary">which lists all tests in the universe for <span class="extract"><span class="ConsoleText-extract-syntax">launcher</span></span> which match one of the
lines from the <span class="extract"><span class="ConsoleText-extract-syntax">rockets.testgroup</span></span>.
</p>

<p class="commentary firstcommentary"><a id="SP15" class="paragraph-anchor"></a><b>&#167;15. Specifying the recipes. </b>A recipe file must also define at least one recipe. There are two ways
to do this:
</p>

<p class="commentary"><span class="extract"><span class="ConsoleText-extract-syntax">-recipe [NAME] FILE</span></span> says that the recipe <span class="extract"><span class="ConsoleText-extract-syntax">[NAME]</span></span> is defined in the given
text file.
</p>

<p class="commentary"><span class="extract"><span class="ConsoleText-extract-syntax">-recipe [NAME]</span></span> followed by a definition written in the intest file itself:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    -recipe [NAME]</span>
<span class="plain-syntax">        ...</span>
<span class="plain-syntax">        ...</span>
<span class="plain-syntax">    -end</span>
</pre>
<p class="commentary">where the definition occupies the lines in between the <span class="extract"><span class="extract-syntax">-recipe</span></span> line and the
<span class="extract"><span class="extract-syntax">-end</span></span> line. (Those lines in between are not commands and don't start with
dashes.) If no <span class="extract"><span class="extract-syntax">[NAME]</span></span> is given, the name is assumed to be just <span class="extract"><span class="extract-syntax">[Recipe]</span></span>.
</p>

<p class="commentary">For how to write recipes, see//Writing Intest Recipes//.
</p>

<p class="commentary firstcommentary"><a id="SP16" class="paragraph-anchor"></a><b>&#167;16. The annotations in a test case. </b>As noted above, an annotated case opens with key-value pairs specifying
details about it: this run ends with a blank line, and then the actual
test material begins.
</p>

<p class="commentary">For example, this might be the block of annotations at the top of a test case:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    Test: Nettles</span>
<span class="plain-syntax">    Language: Basic</span>
<span class="plain-syntax">    For: Glulx</span>
<span class="plain-syntax">    IntOptions: -u -q -dataresourcetext '3:$PATH/Nettles--X.txt'</span>
</pre>
<p class="commentary">What does Intest do with this information? The answer is not much. The opening
line is significant, in that it tells Intest that this file is indeed a
test case, and supplies a title for the test. (Without such an annotation,
the title would be set equal to the name.)
</p>

<p class="commentary">The other key-value pairs here are for the benefit of other programs. Examples,
which are intended as documentation for Inform, use some of these to say where
they should appear in the manual (or in an extension's documentation), how
they should be indexed, and so on:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    Example: ** Alpha</span>
<span class="plain-syntax">    Location: Regular expression matching</span>
<span class="plain-syntax">    RecipeLocation: Testing</span>
<span class="plain-syntax">    Index: Testing command</span>
<span class="plain-syntax">    Description: Creating a beta-testing command that matches any line starting with punctuation.</span>
<span class="plain-syntax">    For: Z-Machine</span>
</pre>
<p class="commentary">So here, the keys <span class="extract"><span class="extract-syntax">Location</span></span>, <span class="extract"><span class="extract-syntax">RecipeLocation</span></span>, <span class="extract"><span class="extract-syntax">Index</span></span>, and <span class="extract"><span class="extract-syntax">Description</span></span> are
all for use by Indoc, and are not likely to matter to how the test is conducted.
There's actually a hidden key-value pair in this case: <span class="extract"><span class="extract-syntax">Stars</span></span>, which is set
here to <span class="extract"><span class="extract-syntax">**</span></span>.
</p>

<p class="commentary">What Intest does with all key-value pairs in these annotations, though, is to
pass them to the test recipe as variables. So, for example, when the example
<span class="extract"><span class="extract-syntax">Alpha</span></span> is tested, the recipe would begin with the variable <span class="extract"><span class="extract-syntax">$FOR</span></span> set to the
value <span class="extract"><span class="extract-syntax">Z-Machine</span></span>. (Note that key names are fully capitalized when used as
variable names in this way.)
</p>

<p class="commentary">The practical effect is that individual test cases can specify variations
in how they should be tested, in a way which the test recipe can make use of.
When there are thousands of cases and some of them intentionally abuse the
program under test, quite a lot of flexibility is needed, and these annotations
make it much easier to write a recipe to handle every need.
</p>

<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="M-iatcl.html">&#10094;</a></li><li class="progresscurrentchapter">M</li><li class="progresssection"><a href="M-iti.html">iti</a></li><li class="progresssection"><a href="M-iatcl.html">iatcl</a></li><li class="progresscurrent">tuoc</li><li class="progresssection"><a href="M-wir.html">wir</a></li><li class="progresssection"><a href="M-rc.html">rc</a></li><li class="progresschapter"><a href="P-htpw.html">P</a></li><li class="progresschapter"><a href="1-bsc.html">1</a></li><li class="progresschapter"><a href="2-rf.html">2</a></li><li class="progresschapter"><a href="3-ts.html">3</a></li><li class="progresschapter"><a href="4-tdc.html">4</a></li><li class="progressnext"><a href="M-wir.html">&#10095;</a></li></ul></div>
</nav><!--End of weave-->

		</main>
	</body>
</html>

